<html>
  <head>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-sharedspace-component@1.0.1/dist/aframe-sharedspace-component.min.js"></script>

    <link rel="stylesheet" href="css/help.css" type="text/css" />
  </head>
  <body>

    <a-scene embedded sharedspace avatars>
      <a-entity camera>
        <a-entity cursor="rayOrigin: mouse;"></a-entity>
      </a-entity>
    </a-scene>
    <div class="piva">
      completed:
      <div class="completed">
        <div class="hide" id="map"></div>
      </div>
      Send hint:
      <div class="customHint" id="pivaCustomHint" contenteditable="true"></div>
      <div class="send" id="send" onclick="pivaSendHint();">
        send
      </div>
      Sent hints:
      <div class="sent" id="pivaSent"></div>
    </div>
    <div class="lloyd">
      Completed:
      <div class="completed">
        <div class="hide" id="image1"></div>
      </div>
      Send hint:
      <div class="customHint" id="lloydCustomHint" contenteditable="true"></div>
      <div class="send" id="lloydSend" onclick="lloydSendHint();">
        send
      </div>
      Sent hints:
      <div class="sent" id="lloydSent"></div>
    </div>
    <script>
      var currentUrl = new URL(window.location);
      var roomName = currentUrl.search.substr(1);
      var room = document.querySelector('[sharedspace]');

      // Sent buttons
      var sent = document.getElementById("pivaSent");
      var customHint = document.getElementById("pivaCustomHint");

      var map = document.getElementById("map");


      function pivaSendHint(){
        if(sent.innerHTML == ""){
          sent.innerHTML = sent.innerHTML + customHint.innerHTML;
        }
        else{
          sent.innerHTML = sent.innerHTML + "<br />" + customHint.innerHTML;
        }
        room.components.sharedspace.send('*', {
          type: 'hint1',
          mainmessage: customHint.innerHTML
        })
      }

      room.addEventListener('participantmessage', function(evt) {
          if (evt.detail.message.type === 'map') {
            map.classList.add("puzzle1");
            map.classList.remove("hide");
          }
          if (evt.detail.message.type === 'continueToLloyd') {

          }
      });
      room.setAttribute('sharedspace', {room: 101, hold: false});
    </script>
  </body>
</html>
